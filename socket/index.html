<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <title>Socket: 
Socket - ReactPHP</title>

        <meta name="description" content="Async, streaming plaintext TCP/IP and secure TLS socket server and client connections for ReactPHP.">

        <link rel="apple-touch-icon" sizes="180x180" href="https://reactphp.org/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="https://reactphp.org/favicon-32x32.png">
        <link rel="manifest" href="https://reactphp.org/manifest.json">
        <link rel="mask-icon" href="https://reactphp.org/safari-pinned-tab.svg" color="#4f5b93">
        <meta name="apple-mobile-web-app-title" content="ReactPHP">
        <meta name="application-name" content="ReactPHP">
        <meta name="theme-color" content="#f4f3f1">
        <meta name="msapplication-config" content="https://reactphp.org/browserconfig.xml" />

        <meta property="og:image" content="https://reactphp.org/og-image.png">

            <script>window.__assets = '../assets/';</script>

        <link rel="preload" href="../assets/19ca4d35c8f94db0fa14422334dd2ad3.woff" as="font" type="font/woff" crossorigin>
        <link rel="preload" href="../assets/be4ba3dd17008135675e945b630be8f6.woff" as="font" type="font/woff" crossorigin>

        <style>@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:400;font-display:swap;src:local("Source Sans Pro Regular"),local("SourceSansPro-Regular"),url(../assets/19ca4d35c8f94db0fa14422334dd2ad3.woff) format("woff")}@font-face{font-family:Source Sans Pro;font-style:normal;font-weight:700;font-display:swap;src:local("Source Sans Pro Bold"),local("SourceSansPro-Bold"),url(../assets/be4ba3dd17008135675e945b630be8f6.woff) format("woff")}html{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif;font-size:16px;line-height:1.6}@media (max-width:768px){html{font-size:18px}}*,:after,:before{box-sizing:inherit}body{margin:0;color:#584b4f;background-color:#fff}blockquote,fieldset,form,h1,h2,h3,h4,h5,h6,hr,ol,p,ul{margin:0 0 16px}ul ul{margin-bottom:0}hr{clear:both;height:0;border:0;border-bottom:1px dashed #eae8e3;padding:0}h1,h2,h3,h4,h5,h6{line-height:1;-webkit-font-smoothing:antialiased;color:#584b4f;font-family:Source Sans Pro,Helvetica Neue,Arial,sans-serif;font-weight:700}h1{font-size:40px;font-size:2.5rem;margin-bottom:32px;color:#4f5b93;letter-spacing:-1px}h1:not(:first-child){margin-top:32px}h2{font-size:32px;font-size:2rem;margin-bottom:32px;color:#4f5b93}h2:not(:first-child){margin-top:32px}h3{font-size:24px;font-size:1.5rem;margin-bottom:24px}h3:not(:first-child){margin-top:24px}h4{font-size:20px;font-size:1.25rem;color:#4f5b93}h4:not(:first-child){margin-top:24px}@media (max-width:768px){h1{font-size:2rem}h2{font-size:1.75rem;margin-bottom:32px}}.container{padding:32px}@media (max-width:768px){.container{padding:16px}}.wrapper{max-width:1600px;margin:auto}.wrapper--medium{max-width:1280px}.wrapper--small{max-width:960px;margin:auto}.wrapper--narrow{max-width:640px}.main{width:calc(98% - 400px)}.main,.sidebar{margin-bottom:32px}.sidebar{width:calc(400px - 2%)}@media (max-width:1024px){.main,.sidebar{width:auto;margin-top:16px}}.visually-hidden{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px)}.grid{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:102%;margin-left:-2%}.grid>*{margin-left:2%;max-width:100%}.grid--4cols>*{-ms-flex-preferred-size:23%;flex-basis:23%}.grid--3cols>*{-ms-flex-preferred-size:31.33%;flex-basis:31.33%}.grid--2cols>*{-ms-flex-preferred-size:48%;flex-basis:48%}@media (max-width:768px){.grid{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.grid,.grid>*{width:100%;margin-left:0}.grid>*{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}}.header{width:100%;background:#fefefe;box-shadow:0 1px 0 0 rgba(0,0,0,.08);padding:0 32px}@media (max-width:768px){.header{padding:0 16px}}.header__container{width:100%;position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.header__logo{display:block;line-height:1;padding:16px 0}.header__logo svg{display:block;width:120px;height:18px}.header__search{margin:0;position:absolute;right:48px;top:7px;z-index:799}.header__search input{width:400px}@media (max-width:768px){.header__search input{width:calc(100vw - 94px)}}.header__menu{position:absolute;right:-12px;top:0;z-index:800}.hamburger{visibility:hidden}.searchbox{width:100%}.searchbox,.searchbox:focus{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:6px 8px 6px 32px;font-size:14px;font-size:.875rem;line-height:24px;color:#584b4f;border:0}.searchbox--collapsed:not(:focus){background-color:transparent;border:0;width:32px!important;margin-right:-12px}.welcome__intro{padding:16px 0 136px;border-bottom:1px dashed #eae8e3;background-image:radial-gradient(ellipse at center,#fff 0,#eae8e3 100%);background-size:auto 100%;background-position:50% 0}.welcome__intro h1{font-size:32px;font-size:2rem;margin-bottom:16px;color:#4f5b93}.welcome__logo{display:block;margin:0 auto;max-width:320px}.welcome__logo svg{display:block;height:240px}.welcome__content{padding-top:16px;display:block;max-width:calc(98% - 320px)}.welcome__example{display:block;margin:auto;max-width:800px;margin-top:-160px}.welcome__example .highlight pre{padding:32px;background:#fff;box-shadow:0 0 16px #d6d1c8}.welcome__intro .links a{color:#584b4f;text-decoration:none}.welcome__intro .links a:hover{color:#4f5b93;text-decoration:none}@media (max-width:768px){.welcome__content{padding:32px 16px 16px;max-width:100%}.welcome__logo svg{height:160px}.welcome__intro h1{text-align:center;font-size:1.75rem;margin-bottom:16px;color:#4f5b93}.welcome__intro .links{text-align:center}}code,pre,tt{font-family:Consolas,Liberation Mono,Menlo,Courier,monospace}code,tt{font-size:12px;font-size:.75rem}pre{font-size:14px;font-size:.875rem;line-height:1.45}@media (max-width:768px){pre{font-size:.75rem}}.links{margin:0;padding:0}.links li{display:inline-block;margin:0 8px;text-decoration:none}.links li:first-child{margin-left:0}.links li:last-child{margin-right:0}.links a{display:block}.links a,.links a:hover{text-decoration:none}.off-canvas-menu{position:fixed;top:0;right:0;-webkit-transform:translate3d(105%,0,0);transform:translate3d(105%,0,0)}.component-info__contributors,.component-info__title{display:-webkit-box;display:-ms-flexbox;display:flex}.component-info__contributors{-ms-flex-wrap:wrap;flex-wrap:wrap;padding:0;list-style:none}.component-info__contributors img{display:block;width:40px;height:auto}.version-selector__panel{position:fixed;top:-20000em;visibility:hidden}</style>
        <link rel="preload" href="../assets/main.2c3050a7d983f67a1210.css" as="style" onload="this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="../assets/main.2c3050a7d983f67a1210.css"></noscript>

        <script>!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=5)}([function(e,t,n){n.p=window.__assets},,,,,function(e,t,n){n(0),e.exports=n(6)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7);Object(r.a)(),n(8),n(10),n(11),n(13),n(15)},function(e,t,n){"use strict";function r(e){try{return(e||window).document.createElement("link").relList.supports("preload")}catch(e){return!1}}function o(e){function t(){for(var e=r.querySelectorAll('link[rel="preload"][as="style"]'),t=0,n=e.length;t<n;t++)!function(t,n){var o=e[t];o.rel="";var i=r.createElement("link");i.rel="stylesheet",i.href=o.href,i.media="only x";var u=function(){i.media=o.getAttribute("media")||"all",i.removeEventListener("load",u)};i.addEventListener("load",u),o.parentNode.insertBefore(i,o.nextSibling||o)}(t)}var n=e||window,r=n.document;if(t(),"complete"!==r.readyState){var o=n.setInterval(t,300);n.addEventListener("load",function(){t(),n.clearInterval(o)})}}function i(e){r(e)||o(e)}t.a=i},function(e,t){},,function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12);n.n(r)},function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(14);n.n(r)},function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16);n.n(r)},function(e,t){}]);</script>
                </head>

    <body>
            <header class="header">
            <div class="wrapper">
                <div class="header__container">
                    <a class="header__logo" href="../">
                        <svg xmlns="http://www.w3.org/2000/svg" width="320" height="47.29" viewBox="0 428.964 320 47.29"><path fill="#584B4F" d="M30.86 452.385c1.637-2.287 2.455-5 2.455-8.134 0-4.313-1.367-7.87-4.088-10.68-2.723-2.812-6.39-4.216-11.004-4.216h-7.71c-3.79 0-6.49.798-8.1 2.388C.806 433.332 0 435.872 0 439.355v36.512h9.08v-17.245h6.53l9.08 17.245h10.52L24.82 457.12c2.395-.87 4.41-2.447 6.04-4.735zm-8.488-3.334c-1.24 1.33-2.82 1.99-4.734 1.99H9.08v-9.47c0-2.74 1.35-4.112 4.05-4.112h4.508c2 0 3.603.61 4.8 1.83 1.196 1.22 1.797 2.82 1.797 4.802 0 1.982-.623 3.64-1.864 4.964v-.003zm20.348 14.536c0 4.572 1.055 7.766 3.167 9.57 2.114 1.81 5.782 2.71 11.008 2.71h16.46v-8.1H57.548c-2.18 0-3.68-.35-4.51-1.045-.83-.695-1.24-1.96-1.24-3.788v-6.467h14.434l.656-8.1h-15.09v-10.912h21.56v-8.098H42.72v34.23zm57.97-33.442c-.718-.523-1.665-.787-2.84-.787-1.177 0-2.168.285-2.972.85-.807.567-1.537 1.592-2.19 3.073l-14.89 42.585h9.47l2.55-8.03h15.613l2.613 8.03h9.47l-14.893-42.588c-.567-1.572-1.21-2.613-1.93-3.135v.002zM92.1 460.19l5.75-18.42 5.487 18.418H92.1v.002zm53.074 5.455c-1.155 1.678-3.245 2.512-6.27 2.512-3.03 0-5.258-.914-6.697-2.74-1.394-1.83-2.093-5.25-2.093-10.256v-4.052c0-1.783.045-3.2.13-4.243.178-3.27.785-5.576 1.833-6.928 1.48-1.914 3.745-2.873 6.794-2.873 2.613 0 4.532.653 5.75 1.96 1.218 1.308 2.07 3.245 2.547 5.813h8.49c0-5.14-1.557-9.07-4.67-11.79-3.114-2.723-7.153-4.084-12.116-4.084-3.398 0-6.293.564-8.687 1.7-6.097 2.783-9.146 9.686-9.146 20.704v3.918c0 13.982 5.945 20.968 17.833 20.968 5.4 0 9.58-1.59 12.54-4.77 2.964-3.176 4.44-7.73 4.44-13.653h-8.426c-.346 3.53-1.1 6.134-2.25 7.81v.005zm14.667-36.29v8.1h12.412v38.41h9.08v-38.41h12.47v-8.1"/><path fill="#4F5B93" d="M218.89 429.356h-18.03v46.51h9.086v-14.897h8.944c4.876 0 8.647-1.337 11.328-4.016 2.683-2.68 4.02-6.608 4.02-11.788s-1.337-9.112-4.02-11.788c-2.68-2.68-6.454-4.02-11.328-4.02v-.002zm4.538 21.686c-1.15 1.177-2.815 1.768-5 1.768h-8.485v-15.354h8.484c4.483 0 6.73 2.572 6.73 7.71 0 2.744-.578 4.703-1.73 5.88v-.004zm43.93-2.02H250.31v-19.666h-9.088v46.51h9.086v-18.81h17.05v18.81h9.076v-46.51h-9.078m48.63 4.02c-2.683-2.68-6.46-4.02-11.335-4.02h-18.027v46.507h9.085V460.97h8.943c4.877 0 8.654-1.336 11.337-4.014 2.68-2.678 4.013-6.608 4.013-11.788s-1.332-9.112-4.013-11.79v-.003zm-6.795 17.666c-1.154 1.177-2.822 1.768-5 1.768h-8.484v-15.354h8.485c4.483 0 6.734 2.572 6.734 7.71 0 2.744-.583 4.703-1.735 5.88v-.004z"/></svg>
                    </a>
                    <form class="header__search">
                        <input type="search" class="searchbox searchbox--collapsed" data-docsearch placeholder="Search documentation...">
                    </form>
                    <div class="header__menu">
    <button class="hamburger" aria-expanded="false" aria-controls="off-canvas-menu" data-off-canvas-menu-toggle>
        <div class="hamburger__box">
            <div class="hamburger__inner">
                <span class="visually-hidden">Menu</span>
            </div>
        </div>
    </button>
</div>
<nav id="off-canvas-menu" class="off-canvas-menu" aria-hidden="true">
    <div class="off-canvas-menu__content">
        <button aria-label="Close menu" class="off-canvas-menu__close" aria-expanded="false" aria-controls="off-canvas-menu" data-off-canvas-menu-toggle>
            <i class="icon-x" aria-hidden="true"></i>
        </button>

        <section class="off-canvas-menu__section">
            <a class="off-canvas-menu__section-top" href="../">Home</a>
        </section>
            <section class="off-canvas-menu__section">
            <h3 class="off-canvas-menu__section-header">Core Components</h3>
            <ul class="off-canvas-menu__list">
                            <li>
                    <a class="off-canvas-menu__link" href="../event-loop/">
                        EventLoop

                        <span class="off-canvas-menu__version">
                            v0.4.3
                        </span>
                    </a>
                </li>
                            <li>
                    <a class="off-canvas-menu__link" href="../stream/">
                        Stream

                        <span class="off-canvas-menu__version">
                            v0.7.6
                        </span>
                    </a>
                </li>
                            <li>
                    <a class="off-canvas-menu__link" href="../promise/">
                        Promise

                        <span class="off-canvas-menu__version">
                            v2.5.1
                        </span>
                    </a>
                </li>
                        </ul>
        </section>
            <section class="off-canvas-menu__section">
            <h3 class="off-canvas-menu__section-header">Network Components</h3>
            <ul class="off-canvas-menu__list">
                            <li>
                    <a class="off-canvas-menu__link" href="../socket/">
                        Socket

                        <span class="off-canvas-menu__version">
                            v0.8.9
                        </span>
                    </a>
                </li>
                            <li>
                    <a class="off-canvas-menu__link" href="../datagram/">
                        Datagram

                        <span class="off-canvas-menu__version">
                            v1.3.0
                        </span>
                    </a>
                </li>
                        </ul>
        </section>
            <section class="off-canvas-menu__section">
            <h3 class="off-canvas-menu__section-header">Protocol Components</h3>
            <ul class="off-canvas-menu__list">
                            <li>
                    <a class="off-canvas-menu__link" href="../http/">
                        HTTP

                        <span class="off-canvas-menu__version">
                            v0.8.1
                        </span>
                    </a>
                </li>
                            <li>
                    <a class="off-canvas-menu__link" href="../http-client/">
                        HTTPClient

                        <span class="off-canvas-menu__version">
                            v0.5.6
                        </span>
                    </a>
                </li>
                            <li>
                    <a class="off-canvas-menu__link" href="../dns/">
                        DNS

                        <span class="off-canvas-menu__version">
                            v0.4.12
                        </span>
                    </a>
                </li>
                        </ul>
        </section>
            <section class="off-canvas-menu__section">
            <h3 class="off-canvas-menu__section-header">Utility Components</h3>
            <ul class="off-canvas-menu__list">
                            <li>
                    <a class="off-canvas-menu__link" href="../cache/">
                        Cache

                        <span class="off-canvas-menu__version">
                            v0.4.2
                        </span>
                    </a>
                </li>
                            <li>
                    <a class="off-canvas-menu__link" href="../child-process/">
                        ChildProcess

                        <span class="off-canvas-menu__version">
                            v0.5.2
                        </span>
                    </a>
                </li>
                            <li>
                    <a class="off-canvas-menu__link" href="../promise-timer/">
                        PromiseTimer

                        <span class="off-canvas-menu__version">
                            v1.2.1
                        </span>
                    </a>
                </li>
                            <li>
                    <a class="off-canvas-menu__link" href="../promise-stream/">
                        PromiseStream

                        <span class="off-canvas-menu__version">
                            v1.1.1
                        </span>
                    </a>
                </li>
                        </ul>
        </section>
        </div>
</nav>                </div>
            </div>
        </header>
    
        <div class="container">
        <div class="wrapper">
            <div class="grid grid--wrap grid--gutter">
                <main class="main">
                    <h1>
<a id="socket" class="anchor" href="#socket" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Socket</h1>
<p><a href="https://travis-ci.org/reactphp/socket" rel="nofollow"><img src="https://camo.githubusercontent.com/bd4896d7cbfc5054f3eb51b2b30e141abce8dd0b/68747470733a2f2f7472617669732d63692e6f72672f72656163747068702f736f636b65742e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/reactphp/socket.svg?branch=master" style="max-width:100%;"></a></p>
<p>Async, streaming plaintext TCP/IP and secure TLS socket server and client
connections for <a href="https://reactphp.org/" rel="nofollow">ReactPHP</a>.</p>
<p>The socket library provides re-usable interfaces for a socket-layer
server and client based on the <a href="../event-loop/"><code>EventLoop</code></a>
and <a href="../stream/"><code>Stream</code></a> components.
Its server component allows you to build networking servers that accept incoming
connections from networking clients (such as an HTTP server).
Its client component allows you to build networking clients that establish
outgoing connections to networking servers (such as an HTTP or database client).
This library provides async, streaming means for all of this, so you can
handle multiple concurrent connections without blocking.</p>
<p><strong>Table of Contents</strong></p>
<ul>
<li><a href="#quickstart-example">Quickstart example</a></li>
<li>
<a href="#connection-usage">Connection usage</a>
<ul>
<li>
<a href="#connectioninterface">ConnectionInterface</a>
<ul>
<li><a href="#getremoteaddress">getRemoteAddress()</a></li>
<li><a href="#getlocaladdress">getLocalAddress()</a></li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#server-usage">Server usage</a>
<ul>
<li>
<a href="#serverinterface">ServerInterface</a>
<ul>
<li><a href="#connection-event">connection event</a></li>
<li><a href="#error-event">error event</a></li>
<li><a href="#getaddress">getAddress()</a></li>
<li><a href="#pause">pause()</a></li>
<li><a href="#resume">resume()</a></li>
<li><a href="#close">close()</a></li>
</ul>
</li>
<li><a href="#server">Server</a></li>
<li>
<a href="#advanced-server-usage">Advanced server usage</a>
<ul>
<li><a href="#tcpserver">TcpServer</a></li>
<li><a href="#secureserver">SecureServer</a></li>
<li><a href="#unixserver">UnixServer</a></li>
<li>
<a href="#limitingserver">LimitingServer</a>
<ul>
<li><a href="#getconnections">getConnections()</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<a href="#client-usage">Client usage</a>
<ul>
<li>
<a href="#connectorinterface">ConnectorInterface</a>
<ul>
<li><a href="#connect">connect()</a></li>
</ul>
</li>
<li><a href="#connector">Connector</a></li>
<li>
<a href="#advanced-client-usage">Advanced client usage</a>
<ul>
<li><a href="#tcpconnector">TcpConnector</a></li>
<li><a href="#dnsconnector">DnsConnector</a></li>
<li><a href="#secureconnector">SecureConnector</a></li>
<li><a href="#timeoutconnector">TimeoutConnector</a></li>
<li><a href="#unixconnector">UnixConnector</a></li>
<li><a href="#fixeduriconnector">FixUriConnector</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#install">Install</a></li>
<li><a href="#tests">Tests</a></li>
<li><a href="#license">License</a></li>
</ul>
<h2>
<a id="quickstart-example" class="anchor" href="#quickstart-example" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Quickstart example</h2>
<p>Here is a server that closes the connection if you send it anything:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$loop</span> <span class="pl-k">=</span> <span class="pl-c1">React\EventLoop\</span><span class="pl-c1">Factory</span><span class="pl-k">::</span>create();</span>
<span class="pl-s1"><span class="pl-smi">$socket</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">React\Socket\</span><span class="pl-c1">Server</span>(<span class="pl-s"><span class="pl-pds">'</span>127.0.0.1:8080<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$socket</span><span class="pl-k">-&gt;</span>on(<span class="pl-s"><span class="pl-pds">'</span>connection<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$conn</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$conn</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">"</span>Hello <span class="pl-pds">"</span></span> <span class="pl-k">.</span> <span class="pl-smi">$conn</span><span class="pl-k">-&gt;</span>getRemoteAddress() <span class="pl-k">.</span> <span class="pl-s"><span class="pl-pds">"</span>!<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);</span>
<span class="pl-s1">    <span class="pl-smi">$conn</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">"</span>Welcome to this amazing server!<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);</span>
<span class="pl-s1">    <span class="pl-smi">$conn</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">"</span>Here's a tip: don't say anything.<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-smi">$conn</span><span class="pl-k">-&gt;</span>on(<span class="pl-s"><span class="pl-pds">'</span>data<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-smi">$data</span>) <span class="pl-k">use</span> (<span class="pl-smi">$conn</span>) {</span>
<span class="pl-s1">        <span class="pl-smi">$conn</span><span class="pl-k">-&gt;</span>close();</span>
<span class="pl-s1">    });</span>
<span class="pl-s1">});</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$loop</span><span class="pl-k">-&gt;</span>run();</span></pre></div>
<p>See also the <a href="https://github.com/reactphp/socket/blob/v0.8.9/examples">examples</a>.</p>
<p>Here's a client that outputs the output of said server and then attempts to
send it a string:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$loop</span> <span class="pl-k">=</span> <span class="pl-c1">React\EventLoop\</span><span class="pl-c1">Factory</span><span class="pl-k">::</span>create();</span>
<span class="pl-s1"><span class="pl-smi">$connector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">React\Socket\</span><span class="pl-c1">Connector</span>(<span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$connector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>127.0.0.1:8080<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>then(<span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$conn</span>) <span class="pl-k">use</span> (<span class="pl-smi">$loop</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$conn</span><span class="pl-k">-&gt;</span>pipe(<span class="pl-k">new</span> <span class="pl-c1">React\Stream\</span><span class="pl-c1">WritableResourceStream</span>(<span class="pl-c1">STDOUT</span>, <span class="pl-smi">$loop</span>));</span>
<span class="pl-s1">    <span class="pl-smi">$conn</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">"</span>Hello World!<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);</span>
<span class="pl-s1">});</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$loop</span><span class="pl-k">-&gt;</span>run();</span></pre></div>
<h2>
<a id="connection-usage" class="anchor" href="#connection-usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Connection usage</h2>
<h3>
<a id="connectioninterface" class="anchor" href="#connectioninterface" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>ConnectionInterface</h3>
<p>The <code>ConnectionInterface</code> is used to represent any incoming and outgoing
connection, such as a normal TCP/IP connection.</p>
<p>An incoming or outgoing connection is a duplex stream (both readable and
writable) that implements React's
<a href="../stream/#duplexstreaminterface"><code>DuplexStreamInterface</code></a>.
It contains additional properties for the local and remote address (client IP)
where this connection has been established to/from.</p>
<p>Most commonly, instances implementing this <code>ConnectionInterface</code> are emitted
by all classes implementing the <a href="#serverinterface"><code>ServerInterface</code></a> and
used by all classes implementing the <a href="#connectorinterface"><code>ConnectorInterface</code></a>.</p>
<p>Because the <code>ConnectionInterface</code> implements the underlying
<a href="../stream/#duplexstreaminterface"><code>DuplexStreamInterface</code></a>
you can use any of its events and methods as usual:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>on(<span class="pl-s"><span class="pl-pds">'</span>data<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-smi">$chunk</span>) {</span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-smi">$chunk</span>;</span>
<span class="pl-s1">});</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>on(<span class="pl-s"><span class="pl-pds">'</span>end<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> () {</span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>ended<span class="pl-pds">'</span></span>;</span>
<span class="pl-s1">});</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>on(<span class="pl-s"><span class="pl-pds">'</span>error<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-c1">Exception</span> <span class="pl-smi">$e</span>) {</span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>error: <span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-smi">$e</span><span class="pl-k">-&gt;</span>getMessage();</span>
<span class="pl-s1">});</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>on(<span class="pl-s"><span class="pl-pds">'</span>close<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> () {</span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>closed<span class="pl-pds">'</span></span>;</span>
<span class="pl-s1">});</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-smi">$data</span>);</span>
<span class="pl-s1"><span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>end(<span class="pl-smi">$data</span> <span class="pl-k">=</span> <span class="pl-c1">null</span>);</span>
<span class="pl-s1"><span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>close();</span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> …</span></span></pre></div>
<p>For more details, see the
<a href="../stream/#duplexstreaminterface"><code>DuplexStreamInterface</code></a>.</p>
<h4>
<a id="getremoteaddress" class="anchor" href="#getremoteaddress" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>getRemoteAddress()</h4>
<p>The <code>getRemoteAddress(): ?string</code> method returns the full remote address
(URI) where this connection has been established with.</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$address</span> <span class="pl-k">=</span> <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>getRemoteAddress();</span>
<span class="pl-s1"><span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>Connection with <span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-smi">$address</span> <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>;</span></pre></div>
<p>If the remote address can not be determined or is unknown at this time (such as
after the connection has been closed), it MAY return a <code>NULL</code> value instead.</p>
<p>Otherwise, it will return the full address (URI) as a string value, such
as <code>tcp://127.0.0.1:8080</code>, <code>tcp://[::1]:80</code>, <code>tls://127.0.0.1:443</code>,
<code>unix://example.sock</code> or <code>unix:///path/to/example.sock</code>.
Note that individual URI components are application specific and depend
on the underlying transport protocol.</p>
<p>If this is a TCP/IP based connection and you only want the remote IP, you may
use something like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$address</span> <span class="pl-k">=</span> <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>getRemoteAddress();</span>
<span class="pl-s1"><span class="pl-smi">$ip</span> <span class="pl-k">=</span> <span class="pl-c1">trim</span>(<span class="pl-c1">parse_url</span>(<span class="pl-smi">$address</span>, <span class="pl-c1">PHP_URL_HOST</span>), <span class="pl-s"><span class="pl-pds">'</span>[]<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>Connection with <span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-smi">$ip</span> <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>;</span></pre></div>
<h4>
<a id="getlocaladdress" class="anchor" href="#getlocaladdress" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>getLocalAddress()</h4>
<p>The <code>getLocalAddress(): ?string</code> method returns the full local address
(URI) where this connection has been established with.</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$address</span> <span class="pl-k">=</span> <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>getLocalAddress();</span>
<span class="pl-s1"><span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>Connection with <span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-smi">$address</span> <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>;</span></pre></div>
<p>If the local address can not be determined or is unknown at this time (such as
after the connection has been closed), it MAY return a <code>NULL</code> value instead.</p>
<p>Otherwise, it will return the full address (URI) as a string value, such
as <code>tcp://127.0.0.1:8080</code>, <code>tcp://[::1]:80</code>, <code>tls://127.0.0.1:443</code>,
<code>unix://example.sock</code> or <code>unix:///path/to/example.sock</code>.
Note that individual URI components are application specific and depend
on the underlying transport protocol.</p>
<p>This method complements the <a href="#getremoteaddress"><code>getRemoteAddress()</code></a> method,
so they should not be confused.</p>
<p>If your <code>TcpServer</code> instance is listening on multiple interfaces (e.g. using
the address <code>0.0.0.0</code>), you can use this method to find out which interface
actually accepted this connection (such as a public or local interface).</p>
<p>If your system has multiple interfaces (e.g. a WAN and a LAN interface),
you can use this method to find out which interface was actually
used for this connection.</p>
<h2>
<a id="server-usage" class="anchor" href="#server-usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Server usage</h2>
<h3>
<a id="serverinterface" class="anchor" href="#serverinterface" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>ServerInterface</h3>
<p>The <code>ServerInterface</code> is responsible for providing an interface for accepting
incoming streaming connections, such as a normal TCP/IP connection.</p>
<p>Most higher-level components (such as a HTTP server) accept an instance
implementing this interface to accept incoming streaming connections.
This is usually done via dependency injection, so it's fairly simple to actually
swap this implementation against any other implementation of this interface.
This means that you SHOULD typehint against this interface instead of a concrete
implementation of this interface.</p>
<p>Besides defining a few methods, this interface also implements the
<a href="https://github.com/igorw/evenement"><code>EventEmitterInterface</code></a>
which allows you to react to certain events.</p>
<h4>
<a id="connection-event" class="anchor" href="#connection-event" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>connection event</h4>
<p>The <code>connection</code> event will be emitted whenever a new connection has been
established, i.e. a new client connects to this server socket:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>on(<span class="pl-s"><span class="pl-pds">'</span>connection<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>new connection<span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>;</span>
<span class="pl-s1">});</span></pre></div>
<p>See also the <a href="#connectioninterface"><code>ConnectionInterface</code></a> for more details
about handling the incoming connection.</p>
<h4>
<a id="error-event" class="anchor" href="#error-event" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>error event</h4>
<p>The <code>error</code> event will be emitted whenever there's an error accepting a new
connection from a client.</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>on(<span class="pl-s"><span class="pl-pds">'</span>error<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-c1">Exception</span> <span class="pl-smi">$e</span>) {</span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>error: <span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-smi">$e</span><span class="pl-k">-&gt;</span>getMessage() <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>;</span>
<span class="pl-s1">});</span></pre></div>
<p>Note that this is not a fatal error event, i.e. the server keeps listening for
new connections even after this event.</p>
<h4>
<a id="getaddress" class="anchor" href="#getaddress" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>getAddress()</h4>
<p>The <code>getAddress(): ?string</code> method can be used to
return the full address (URI) this server is currently listening on.</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$address</span> <span class="pl-k">=</span> <span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>getAddress();</span>
<span class="pl-s1"><span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>Server listening on <span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-smi">$address</span> <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>;</span></pre></div>
<p>If the address can not be determined or is unknown at this time (such as
after the socket has been closed), it MAY return a <code>NULL</code> value instead.</p>
<p>Otherwise, it will return the full address (URI) as a string value, such
as <code>tcp://127.0.0.1:8080</code>, <code>tcp://[::1]:80</code>, <code>tls://127.0.0.1:443</code>
<code>unix://example.sock</code> or <code>unix:///path/to/example.sock</code>.
Note that individual URI components are application specific and depend
on the underlying transport protocol.</p>
<p>If this is a TCP/IP based server and you only want the local port, you may
use something like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$address</span> <span class="pl-k">=</span> <span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>getAddress();</span>
<span class="pl-s1"><span class="pl-smi">$port</span> <span class="pl-k">=</span> <span class="pl-c1">parse_url</span>(<span class="pl-smi">$address</span>, <span class="pl-c1">PHP_URL_PORT</span>);</span>
<span class="pl-s1"><span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>Server listening on port <span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-smi">$port</span> <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>;</span></pre></div>
<h4>
<a id="pause" class="anchor" href="#pause" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>pause()</h4>
<p>The <code>pause(): void</code> method can be used to
pause accepting new incoming connections.</p>
<p>Removes the socket resource from the EventLoop and thus stop accepting
new connections. Note that the listening socket stays active and is not
closed.</p>
<p>This means that new incoming connections will stay pending in the
operating system backlog until its configurable backlog is filled.
Once the backlog is filled, the operating system may reject further
incoming connections until the backlog is drained again by resuming
to accept new connections.</p>
<p>Once the server is paused, no futher <code>connection</code> events SHOULD
be emitted.</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>pause();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>on(<span class="pl-s"><span class="pl-pds">'</span>connection<span class="pl-pds">'</span></span>, assertShouldNeverCalled());</span></pre></div>
<p>This method is advisory-only, though generally not recommended, the
server MAY continue emitting <code>connection</code> events.</p>
<p>Unless otherwise noted, a successfully opened server SHOULD NOT start
in paused state.</p>
<p>You can continue processing events by calling <code>resume()</code> again.</p>
<p>Note that both methods can be called any number of times, in particular
calling <code>pause()</code> more than once SHOULD NOT have any effect.
Similarly, calling this after <code>close()</code> is a NO-OP.</p>
<h4>
<a id="resume" class="anchor" href="#resume" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>resume()</h4>
<p>The <code>resume(): void</code> method can be used to
resume accepting new incoming connections.</p>
<p>Re-attach the socket resource to the EventLoop after a previous <code>pause()</code>.</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>pause();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$loop</span><span class="pl-k">-&gt;</span>addTimer(<span class="pl-c1">1.0</span>, <span class="pl-k">function</span> () <span class="pl-k">use</span> (<span class="pl-smi">$server</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>resume();</span>
<span class="pl-s1">});</span></pre></div>
<p>Note that both methods can be called any number of times, in particular
calling <code>resume()</code> without a prior <code>pause()</code> SHOULD NOT have any effect.
Similarly, calling this after <code>close()</code> is a NO-OP.</p>
<h4>
<a id="close" class="anchor" href="#close" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>close()</h4>
<p>The <code>close(): void</code> method can be used to
shut down this listening socket.</p>
<p>This will stop listening for new incoming connections on this socket.</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>Shutting down server socket<span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>;</span>
<span class="pl-s1"><span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>close();</span></pre></div>
<p>Calling this method more than once on the same instance is a NO-OP.</p>
<h3>
<a id="server" class="anchor" href="#server" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Server</h3>
<p>The <code>Server</code> class is the main class in this package that implements the
<a href="#serverinterface"><code>ServerInterface</code></a> and allows you to accept incoming
streaming connections, such as plaintext TCP/IP or secure TLS connection streams.
Connections can also be accepted on Unix domain sockets.</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Server</span>(<span class="pl-c1">8080</span>, <span class="pl-smi">$loop</span>);</span></pre></div>
<p>As above, the <code>$uri</code> parameter can consist of only a port, in which case the
server will default to listening on the localhost address <code>127.0.0.1</code>,
which means it will not be reachable from outside of this system.</p>
<p>In order to use a random port assignment, you can use the port <code>0</code>:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Server</span>(<span class="pl-c1">0</span>, <span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"><span class="pl-smi">$address</span> <span class="pl-k">=</span> <span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>getAddress();</span></pre></div>
<p>In order to change the host the socket is listening on, you can provide an IP
address through the first parameter provided to the constructor, optionally
preceded by the <code>tcp://</code> scheme:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Server</span>(<span class="pl-s"><span class="pl-pds">'</span>192.168.0.1:8080<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>);</span></pre></div>
<p>If you want to listen on an IPv6 address, you MUST enclose the host in square
brackets:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Server</span>(<span class="pl-s"><span class="pl-pds">'</span>[::1]:8080<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>);</span></pre></div>
<p>To listen on a Unix domain socket (UDS) path, you MUST prefix the URI with the
<code>unix://</code> scheme:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Server</span>(<span class="pl-s"><span class="pl-pds">'</span>unix:///tmp/server.sock<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>);</span></pre></div>
<p>If the given URI is invalid, does not contain a port, any other scheme or if it
contains a hostname, it will throw an <code>InvalidArgumentException</code>:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> throws InvalidArgumentException due to missing port</span></span>
<span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Server</span>(<span class="pl-s"><span class="pl-pds">'</span>127.0.0.1<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>);</span></pre></div>
<p>If the given URI appears to be valid, but listening on it fails (such as if port
is already in use or port below 1024 may require root access etc.), it will
throw a <code>RuntimeException</code>:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$first</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Server</span>(<span class="pl-c1">8080</span>, <span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> throws RuntimeException because port is already in use</span></span>
<span class="pl-s1"><span class="pl-smi">$second</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Server</span>(<span class="pl-c1">8080</span>, <span class="pl-smi">$loop</span>);</span></pre></div>
<blockquote>
<p>Note that these error conditions may vary depending on your system and/or
configuration.
See the exception message and code for more details about the actual error
condition.</p>
</blockquote>
<p>Optionally, you can specify <a href="http://php.net/manual/en/context.socket.php" rel="nofollow">TCP socket context options</a>
for the underlying stream socket resource like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Server</span>(<span class="pl-s"><span class="pl-pds">'</span>[::1]:8080<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>tcp<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">array</span>(</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">'</span>backlog<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">200</span>,</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">'</span>so_reuseport<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">true</span>,</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">'</span>ipv6_v6only<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">true</span></span>
<span class="pl-s1">    )</span>
<span class="pl-s1">));</span></pre></div>
<blockquote>
<p>Note that available <a href="http://php.net/manual/en/context.socket.php" rel="nofollow">socket context options</a>,
their defaults and effects of changing these may vary depending on your system
and/or PHP version.
Passing unknown context options has no effect.
For BC reasons, you can also pass the TCP socket context options as a simple
array without wrapping this in another array under the <code>tcp</code> key.</p>
</blockquote>
<p>You can start a secure TLS (formerly known as SSL) server by simply prepending
the <code>tls://</code> URI scheme.
Internally, it will wait for plaintext TCP/IP connections and then performs a
TLS handshake for each connection.
It thus requires valid <a href="http://php.net/manual/en/context.ssl.php" rel="nofollow">TLS context options</a>,
which in its most basic form may look something like this if you're using a
PEM encoded certificate file:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Server</span>(<span class="pl-s"><span class="pl-pds">'</span>tls://127.0.0.1:8080<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>tls<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">array</span>(</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">'</span>local_cert<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>server.pem<span class="pl-pds">'</span></span></span>
<span class="pl-s1">    )</span>
<span class="pl-s1">));</span></pre></div>
<blockquote>
<p>Note that the certificate file will not be loaded on instantiation but when an
incoming connection initializes its TLS context.
This implies that any invalid certificate file paths or contents will only cause
an <code>error</code> event at a later time.</p>
</blockquote>
<p>If your private key is encrypted with a passphrase, you have to specify it
like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Server</span>(<span class="pl-s"><span class="pl-pds">'</span>tls://127.0.0.1:8000<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>tls<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">array</span>(</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">'</span>local_cert<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>server.pem<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">'</span>passphrase<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>secret<span class="pl-pds">'</span></span></span>
<span class="pl-s1">    )</span>
<span class="pl-s1">));</span></pre></div>
<p>By default, this server supports TLSv1.0+ and excludes support for legacy
SSLv2/SSLv3. As of PHP 5.6+ you can also explicitly choose the TLS version you
want to negotiate with the remote side:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Server</span>(<span class="pl-s"><span class="pl-pds">'</span>tls://127.0.0.1:8000<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>tls<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">array</span>(</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">'</span>local_cert<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>server.pem<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">'</span>crypto_method<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">STREAM_CRYPTO_METHOD_TLSv1_2_SERVER</span></span>
<span class="pl-s1">    )</span>
<span class="pl-s1">));</span></pre></div>
<blockquote>
<p>Note that available <a href="http://php.net/manual/en/context.ssl.php" rel="nofollow">TLS context options</a>,
their defaults and effects of changing these may vary depending on your system
and/or PHP version.
The outer context array allows you to also use <code>tcp</code> (and possibly more)
context options at the same time.
Passing unknown context options has no effect.
If you do not use the <code>tls://</code> scheme, then passing <code>tls</code> context options
has no effect.</p>
</blockquote>
<p>Whenever a client connects, it will emit a <code>connection</code> event with a connection
instance implementing <a href="#connectioninterface"><code>ConnectionInterface</code></a>:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>on(<span class="pl-s"><span class="pl-pds">'</span>connection<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>Plaintext connection from <span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>getRemoteAddress() <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>;</span>
<span class="pl-s1">    </span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>hello there!<span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>);</span>
<span class="pl-s1">    …</span>
<span class="pl-s1">});</span></pre></div>
<p>See also the <a href="#serverinterface"><code>ServerInterface</code></a> for more details.</p>
<blockquote>
<p>Note that the <code>Server</code> class is a concrete implementation for TCP/IP sockets.
If you want to typehint in your higher-level protocol implementation, you SHOULD
use the generic <a href="#serverinterface"><code>ServerInterface</code></a> instead.</p>
</blockquote>
<h3>
<a id="advanced-server-usage" class="anchor" href="#advanced-server-usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Advanced server usage</h3>
<h4>
<a id="tcpserver" class="anchor" href="#tcpserver" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>TcpServer</h4>
<p>The <code>TcpServer</code> class implements the <a href="#serverinterface"><code>ServerInterface</code></a> and
is responsible for accepting plaintext TCP/IP connections.</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">TcpServer</span>(<span class="pl-c1">8080</span>, <span class="pl-smi">$loop</span>);</span></pre></div>
<p>As above, the <code>$uri</code> parameter can consist of only a port, in which case the
server will default to listening on the localhost address <code>127.0.0.1</code>,
which means it will not be reachable from outside of this system.</p>
<p>In order to use a random port assignment, you can use the port <code>0</code>:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">TcpServer</span>(<span class="pl-c1">0</span>, <span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"><span class="pl-smi">$address</span> <span class="pl-k">=</span> <span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>getAddress();</span></pre></div>
<p>In order to change the host the socket is listening on, you can provide an IP
address through the first parameter provided to the constructor, optionally
preceded by the <code>tcp://</code> scheme:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">TcpServer</span>(<span class="pl-s"><span class="pl-pds">'</span>192.168.0.1:8080<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>);</span></pre></div>
<p>If you want to listen on an IPv6 address, you MUST enclose the host in square
brackets:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">TcpServer</span>(<span class="pl-s"><span class="pl-pds">'</span>[::1]:8080<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>);</span></pre></div>
<p>If the given URI is invalid, does not contain a port, any other scheme or if it
contains a hostname, it will throw an <code>InvalidArgumentException</code>:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> throws InvalidArgumentException due to missing port</span></span>
<span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">TcpServer</span>(<span class="pl-s"><span class="pl-pds">'</span>127.0.0.1<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>);</span></pre></div>
<p>If the given URI appears to be valid, but listening on it fails (such as if port
is already in use or port below 1024 may require root access etc.), it will
throw a <code>RuntimeException</code>:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$first</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">TcpServer</span>(<span class="pl-c1">8080</span>, <span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> throws RuntimeException because port is already in use</span></span>
<span class="pl-s1"><span class="pl-smi">$second</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">TcpServer</span>(<span class="pl-c1">8080</span>, <span class="pl-smi">$loop</span>);</span></pre></div>
<blockquote>
<p>Note that these error conditions may vary depending on your system and/or
configuration.
See the exception message and code for more details about the actual error
condition.</p>
</blockquote>
<p>Optionally, you can specify <a href="http://php.net/manual/en/context.socket.php" rel="nofollow">socket context options</a>
for the underlying stream socket resource like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">TcpServer</span>(<span class="pl-s"><span class="pl-pds">'</span>[::1]:8080<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>backlog<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">200</span>,</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>so_reuseport<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">true</span>,</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>ipv6_v6only<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">true</span></span>
<span class="pl-s1">));</span></pre></div>
<blockquote>
<p>Note that available <a href="http://php.net/manual/en/context.socket.php" rel="nofollow">socket context options</a>,
their defaults and effects of changing these may vary depending on your system
and/or PHP version.
Passing unknown context options has no effect.</p>
</blockquote>
<p>Whenever a client connects, it will emit a <code>connection</code> event with a connection
instance implementing <a href="#connectioninterface"><code>ConnectionInterface</code></a>:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>on(<span class="pl-s"><span class="pl-pds">'</span>connection<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>Plaintext connection from <span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>getRemoteAddress() <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>;</span>
<span class="pl-s1">    </span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>hello there!<span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>);</span>
<span class="pl-s1">    …</span>
<span class="pl-s1">});</span></pre></div>
<p>See also the <a href="#serverinterface"><code>ServerInterface</code></a> for more details.</p>
<h4>
<a id="secureserver" class="anchor" href="#secureserver" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SecureServer</h4>
<p>The <code>SecureServer</code> class implements the <a href="#serverinterface"><code>ServerInterface</code></a>
and is responsible for providing a secure TLS (formerly known as SSL) server.</p>
<p>It does so by wrapping a <a href="#tcpserver"><code>TcpServer</code></a> instance which waits for plaintext
TCP/IP connections and then performs a TLS handshake for each connection.
It thus requires valid <a href="http://php.net/manual/en/context.ssl.php" rel="nofollow">TLS context options</a>,
which in its most basic form may look something like this if you're using a
PEM encoded certificate file:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">TcpServer</span>(<span class="pl-c1">8000</span>, <span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">SecureServer</span>(<span class="pl-smi">$server</span>, <span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>local_cert<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>server.pem<span class="pl-pds">'</span></span></span>
<span class="pl-s1">));</span></pre></div>
<blockquote>
<p>Note that the certificate file will not be loaded on instantiation but when an
incoming connection initializes its TLS context.
This implies that any invalid certificate file paths or contents will only cause
an <code>error</code> event at a later time.</p>
</blockquote>
<p>If your private key is encrypted with a passphrase, you have to specify it
like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">TcpServer</span>(<span class="pl-c1">8000</span>, <span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">SecureServer</span>(<span class="pl-smi">$server</span>, <span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>local_cert<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>server.pem<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>passphrase<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>secret<span class="pl-pds">'</span></span></span>
<span class="pl-s1">));</span></pre></div>
<p>By default, this server supports TLSv1.0+ and excludes support for legacy
SSLv2/SSLv3. As of PHP 5.6+ you can also explicitly choose the TLS version you
want to negotiate with the remote side:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">TcpServer</span>(<span class="pl-c1">8000</span>, <span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">SecureServer</span>(<span class="pl-smi">$server</span>, <span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>local_cert<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>server.pem<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>crypto_method<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">STREAM_CRYPTO_METHOD_TLSv1_2_SERVER</span></span>
<span class="pl-s1">));</span></pre></div>
<blockquote>
<p>Note that available <a href="http://php.net/manual/en/context.ssl.php" rel="nofollow">TLS context options</a>,
their defaults and effects of changing these may vary depending on your system
and/or PHP version.
Passing unknown context options has no effect.</p>
</blockquote>
<p>Whenever a client completes the TLS handshake, it will emit a <code>connection</code> event
with a connection instance implementing <a href="#connectioninterface"><code>ConnectionInterface</code></a>:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>on(<span class="pl-s"><span class="pl-pds">'</span>connection<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>Secure connection from<span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>getRemoteAddress() <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>;</span>
<span class="pl-s1">    </span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>hello there!<span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>);</span>
<span class="pl-s1">    …</span>
<span class="pl-s1">});</span></pre></div>
<p>Whenever a client fails to perform a successful TLS handshake, it will emit an
<code>error</code> event and then close the underlying TCP/IP connection:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>on(<span class="pl-s"><span class="pl-pds">'</span>error<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-c1">Exception</span> <span class="pl-smi">$e</span>) {</span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>Error<span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-smi">$e</span><span class="pl-k">-&gt;</span>getMessage() <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>;</span>
<span class="pl-s1">});</span></pre></div>
<p>See also the <a href="#serverinterface"><code>ServerInterface</code></a> for more details.</p>
<p>Note that the <code>SecureServer</code> class is a concrete implementation for TLS sockets.
If you want to typehint in your higher-level protocol implementation, you SHOULD
use the generic <a href="#serverinterface"><code>ServerInterface</code></a> instead.</p>
<blockquote>
<p>Advanced usage: Despite allowing any <code>ServerInterface</code> as first parameter,
you SHOULD pass a <code>TcpServer</code> instance as first parameter, unless you
know what you're doing.
Internally, the <code>SecureServer</code> has to set the required TLS context options on
the underlying stream resources.
These resources are not exposed through any of the interfaces defined in this
package, but only through the internal <code>Connection</code> class.
The <code>TcpServer</code> class is guaranteed to emit connections that implement
the <code>ConnectionInterface</code> and uses the internal <code>Connection</code> class in order to
expose these underlying resources.
If you use a custom <code>ServerInterface</code> and its <code>connection</code> event does not
meet this requirement, the <code>SecureServer</code> will emit an <code>error</code> event and
then close the underlying connection.</p>
</blockquote>
<h4>
<a id="unixserver" class="anchor" href="#unixserver" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>UnixServer</h4>
<p>The <code>UnixServer</code> class implements the <a href="#serverinterface"><code>ServerInterface</code></a> and
is responsible for accepting connections on Unix domain sockets (UDS).</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">UnixServer</span>(<span class="pl-s"><span class="pl-pds">'</span>/tmp/server.sock<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>);</span></pre></div>
<p>As above, the <code>$uri</code> parameter can consist of only a socket path or socket path
prefixed by the <code>unix://</code> scheme.</p>
<p>If the given URI appears to be valid, but listening on it fails (such as if the
socket is already in use or the file not accessible etc.), it will throw a
<code>RuntimeException</code>:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$first</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">UnixServer</span>(<span class="pl-s"><span class="pl-pds">'</span>/tmp/same.sock<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> throws RuntimeException because socket is already in use</span></span>
<span class="pl-s1"><span class="pl-smi">$second</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">UnixServer</span>(<span class="pl-s"><span class="pl-pds">'</span>/tmp/same.sock<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>);</span></pre></div>
<p>Whenever a client connects, it will emit a <code>connection</code> event with a connection
instance implementing <a href="#connectioninterface"><code>ConnectionInterface</code></a>:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>on(<span class="pl-s"><span class="pl-pds">'</span>connection<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">'</span>New connection<span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>hello there!<span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>);</span>
<span class="pl-s1">    …</span>
<span class="pl-s1">});</span></pre></div>
<p>See also the <a href="#serverinterface"><code>ServerInterface</code></a> for more details.</p>
<h4>
<a id="limitingserver" class="anchor" href="#limitingserver" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>LimitingServer</h4>
<p>The <code>LimitingServer</code> decorator wraps a given <code>ServerInterface</code> and is responsible
for limiting and keeping track of open connections to this server instance.</p>
<p>Whenever the underlying server emits a <code>connection</code> event, it will check its
limits and then either</p>
<ul>
<li>keep track of this connection by adding it to the list of
open connections and then forward the <code>connection</code> event</li>
<li>or reject (close) the connection when its limits are exceeded and will
forward an <code>error</code> event instead.</li>
</ul>
<p>Whenever a connection closes, it will remove this connection from the list of
open connections.</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">LimitingServer</span>(<span class="pl-smi">$server</span>, <span class="pl-c1">100</span>);</span>
<span class="pl-s1"><span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>on(<span class="pl-s"><span class="pl-pds">'</span>connection<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>hello there!<span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>);</span>
<span class="pl-s1">    …</span>
<span class="pl-s1">});</span></pre></div>
<p>See also the <a href="https://github.com/reactphp/socket/blob/v0.8.9/examples">second example</a> for more details.</p>
<p>You have to pass a maximum number of open connections to ensure
the server will automatically reject (close) connections once this limit
is exceeded. In this case, it will emit an <code>error</code> event to inform about
this and no <code>connection</code> event will be emitted.</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">LimitingServer</span>(<span class="pl-smi">$server</span>, <span class="pl-c1">100</span>);</span>
<span class="pl-s1"><span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>on(<span class="pl-s"><span class="pl-pds">'</span>connection<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>hello there!<span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>);</span>
<span class="pl-s1">    …</span>
<span class="pl-s1">});</span></pre></div>
<p>You MAY pass a <code>null</code> limit in order to put no limit on the number of
open connections and keep accepting new connection until you run out of
operating system resources (such as open file handles). This may be
useful if you do not want to take care of applying a limit but still want
to use the <code>getConnections()</code> method.</p>
<p>You can optionally configure the server to pause accepting new
connections once the connection limit is reached. In this case, it will
pause the underlying server and no longer process any new connections at
all, thus also no longer closing any excessive connections.
The underlying operating system is responsible for keeping a backlog of
pending connections until its limit is reached, at which point it will
start rejecting further connections.
Once the server is below the connection limit, it will continue consuming
connections from the backlog and will process any outstanding data on
each connection.
This mode may be useful for some protocols that are designed to wait for
a response message (such as HTTP), but may be less useful for other
protocols that demand immediate responses (such as a "welcome" message in
an interactive chat).</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">LimitingServer</span>(<span class="pl-smi">$server</span>, <span class="pl-c1">100</span>, <span class="pl-c1">true</span>);</span>
<span class="pl-s1"><span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>on(<span class="pl-s"><span class="pl-pds">'</span>connection<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>hello there!<span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-c1">PHP_EOL</span>);</span>
<span class="pl-s1">    …</span>
<span class="pl-s1">});</span></pre></div>
<h5>
<a id="getconnections" class="anchor" href="#getconnections" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>getConnections()</h5>
<p>The <code>getConnections(): ConnectionInterface[]</code> method can be used to
return an array with all currently active connections.</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">foreach</span> (<span class="pl-smi">$server</span><span class="pl-k">-&gt;</span>getConnection() <span class="pl-k">as</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>Hi!<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">}</span></pre></div>
<h2>
<a id="client-usage" class="anchor" href="#client-usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Client usage</h2>
<h3>
<a id="connectorinterface" class="anchor" href="#connectorinterface" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>ConnectorInterface</h3>
<p>The <code>ConnectorInterface</code> is responsible for providing an interface for
establishing streaming connections, such as a normal TCP/IP connection.</p>
<p>This is the main interface defined in this package and it is used throughout
React's vast ecosystem.</p>
<p>Most higher-level components (such as HTTP, database or other networking
service clients) accept an instance implementing this interface to create their
TCP/IP connection to the underlying networking service.
This is usually done via dependency injection, so it's fairly simple to actually
swap this implementation against any other implementation of this interface.</p>
<p>The interface only offers a single method:</p>
<h4>
<a id="connect" class="anchor" href="#connect" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>connect()</h4>
<p>The <code>connect(string $uri): PromiseInterface&lt;ConnectionInterface, Exception&gt;</code> method
can be used to create a streaming connection to the given remote address.</p>
<p>It returns a <a href="../promise/">Promise</a> which either
fulfills with a stream implementing <a href="#connectioninterface"><code>ConnectionInterface</code></a>
on success or rejects with an <code>Exception</code> if the connection is not successful:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$connector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>google.com:443<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>then(</span>
<span class="pl-s1">    <span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">        <span class="pl-c"><span class="pl-c">//</span> connection successfully established</span></span>
<span class="pl-s1">    },</span>
<span class="pl-s1">    <span class="pl-k">function</span> (<span class="pl-c1">Exception</span> <span class="pl-smi">$error</span>) {</span>
<span class="pl-s1">        <span class="pl-c"><span class="pl-c">//</span> failed to connect due to $error</span></span>
<span class="pl-s1">    }</span>
<span class="pl-s1">);</span></pre></div>
<p>See also <a href="#connectioninterface"><code>ConnectionInterface</code></a> for more details.</p>
<p>The returned Promise MUST be implemented in such a way that it can be
cancelled when it is still pending. Cancelling a pending promise MUST
reject its value with an <code>Exception</code>. It SHOULD clean up any underlying
resources and references as applicable:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$promise</span> <span class="pl-k">=</span> <span class="pl-smi">$connector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-smi">$uri</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$promise</span><span class="pl-k">-&gt;</span>cancel();</span></pre></div>
<h3>
<a id="connector" class="anchor" href="#connector" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Connector</h3>
<p>The <code>Connector</code> class is the main class in this package that implements the
<a href="#connectorinterface"><code>ConnectorInterface</code></a> and allows you to create streaming connections.</p>
<p>You can use this connector to create any kind of streaming connections, such
as plaintext TCP/IP, secure TLS or local Unix connection streams.</p>
<p>It binds to the main event loop and can be used like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$loop</span> <span class="pl-k">=</span> <span class="pl-c1">React\EventLoop\</span><span class="pl-c1">Factory</span><span class="pl-k">::</span>create();</span>
<span class="pl-s1"><span class="pl-smi">$connector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Connector</span>(<span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$connector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-smi">$uri</span>)<span class="pl-k">-&gt;</span>then(<span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>end();</span>
<span class="pl-s1">});</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$loop</span><span class="pl-k">-&gt;</span>run();</span></pre></div>
<p>In order to create a plaintext TCP/IP connection, you can simply pass a host
and port combination like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$connector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>www.google.com:80<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>then(<span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>end();</span>
<span class="pl-s1">});</span></pre></div>
<blockquote>
<p>If you do no specify a URI scheme in the destination URI, it will assume
<code>tcp://</code> as a default and establish a plaintext TCP/IP connection.
Note that TCP/IP connections require a host and port part in the destination
URI like above, all other URI components are optional.</p>
</blockquote>
<p>In order to create a secure TLS connection, you can use the <code>tls://</code> URI scheme
like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$connector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>tls://www.google.com:443<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>then(<span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>end();</span>
<span class="pl-s1">});</span></pre></div>
<p>In order to create a local Unix domain socket connection, you can use the
<code>unix://</code> URI scheme like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$connector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>unix:///tmp/demo.sock<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>then(<span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>end();</span>
<span class="pl-s1">});</span></pre></div>
<blockquote>
<p>The <a href="#getremoteaddress"><code>getRemoteAddress()</code></a> method will return the target
Unix domain socket (UDS) path as given to the <code>connect()</code> method, including
the <code>unix://</code> scheme, for example <code>unix:///tmp/demo.sock</code>.
The <a href="#getlocaladdress"><code>getLocalAddress()</code></a> method will most likely return a
<code>null</code> value as this value is not applicable to UDS connections here.</p>
</blockquote>
<p>Under the hood, the <code>Connector</code> is implemented as a <em>higher-level facade</em>
for the lower-level connectors implemented in this package. This means it
also shares all of their features and implementation details.
If you want to typehint in your higher-level protocol implementation, you SHOULD
use the generic <a href="#connectorinterface"><code>ConnectorInterface</code></a> instead.</p>
<p>In particular, the <code>Connector</code> class uses Google's public DNS server <code>8.8.8.8</code>
to resolve all public hostnames into underlying IP addresses by default.
If you want to use a custom DNS server (such as a local DNS relay or a company
wide DNS server), you can set up the <code>Connector</code> like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$connector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Connector</span>(<span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>dns<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>127.0.1.1<span class="pl-pds">'</span></span></span>
<span class="pl-s1">));</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$connector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>localhost:80<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>then(<span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>end();</span>
<span class="pl-s1">});</span></pre></div>
<p>If you do not want to use a DNS resolver at all and want to connect to IP
addresses only, you can also set up your <code>Connector</code> like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$connector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Connector</span>(<span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>dns<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span></span>
<span class="pl-s1">));</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$connector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>127.0.0.1:80<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>then(<span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>end();</span>
<span class="pl-s1">});</span></pre></div>
<p>Advanced: If you need a custom DNS <code>Resolver</code> instance, you can also set up
your <code>Connector</code> like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$dnsResolverFactory</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">React\Dns\Resolver\</span><span class="pl-c1">Factory</span>();</span>
<span class="pl-s1"><span class="pl-smi">$resolver</span> <span class="pl-k">=</span> <span class="pl-smi">$dnsResolverFactory</span><span class="pl-k">-&gt;</span>createCached(<span class="pl-s"><span class="pl-pds">'</span>127.0.1.1<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$connector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Connector</span>(<span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>dns<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$resolver</span></span>
<span class="pl-s1">));</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$connector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>localhost:80<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>then(<span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>end();</span>
<span class="pl-s1">});</span></pre></div>
<p>By default, the <code>tcp://</code> and <code>tls://</code> URI schemes will use timeout value that
repects your <code>default_socket_timeout</code> ini setting (which defaults to 60s).
If you want a custom timeout value, you can simply pass this like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$connector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Connector</span>(<span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>timeout<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">10.0</span></span>
<span class="pl-s1">));</span></pre></div>
<p>Similarly, if you do not want to apply a timeout at all and let the operating
system handle this, you can pass a boolean flag like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$connector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Connector</span>(<span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>timeout<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span></span>
<span class="pl-s1">));</span></pre></div>
<p>By default, the <code>Connector</code> supports the <code>tcp://</code>, <code>tls://</code> and <code>unix://</code>
URI schemes. If you want to explicitly prohibit any of these, you can simply
pass boolean flags like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> only allow secure TLS connections</span></span>
<span class="pl-s1"><span class="pl-smi">$connector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Connector</span>(<span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>tcp<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span>,</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>tls<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">true</span>,</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>unix<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span>,</span>
<span class="pl-s1">));</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$connector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>tls://google.com:443<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>then(<span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>end();</span>
<span class="pl-s1">});</span></pre></div>
<p>The <code>tcp://</code> and <code>tls://</code> also accept additional context options passed to
the underlying connectors.
If you want to explicitly pass additional context options, you can simply
pass arrays of context options like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> allow insecure TLS connections</span></span>
<span class="pl-s1"><span class="pl-smi">$connector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Connector</span>(<span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>tcp<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">array</span>(</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">'</span>bindto<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>192.168.0.1:0<span class="pl-pds">'</span></span></span>
<span class="pl-s1">    ),</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>tls<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">array</span>(</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">'</span>verify_peer<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span>,</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">'</span>verify_peer_name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span></span>
<span class="pl-s1">    ),</span>
<span class="pl-s1">));</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$connector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>tls://localhost:443<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>then(<span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>end();</span>
<span class="pl-s1">});</span></pre></div>
<p>By default, this connector supports TLSv1.0+ and excludes support for legacy
SSLv2/SSLv3. As of PHP 5.6+ you can also explicitly choose the TLS version you
want to negotiate with the remote side:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$connector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Connector</span>(<span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>tls<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">array</span>(</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">'</span>crypto_method<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">STREAM_CRYPTO_METHOD_TLSv1_2_CLIENT</span></span>
<span class="pl-s1">    )</span>
<span class="pl-s1">));</span></pre></div>
<blockquote>
<p>For more details about context options, please refer to the PHP documentation
about <a href="http://php.net/manual/en/context.socket.php" rel="nofollow">socket context options</a>
and <a href="http://php.net/manual/en/context.ssl.php" rel="nofollow">SSL context options</a>.</p>
</blockquote>
<p>Advanced: By default, the <code>Connector</code> supports the <code>tcp://</code>, <code>tls://</code> and
<code>unix://</code> URI schemes.
For this, it sets up the required connector classes automatically.
If you want to explicitly pass custom connectors for any of these, you can simply
pass an instance implementing the <code>ConnectorInterface</code> like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$dnsResolverFactory</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">React\Dns\Resolver\</span><span class="pl-c1">Factory</span>();</span>
<span class="pl-s1"><span class="pl-smi">$resolver</span> <span class="pl-k">=</span> <span class="pl-smi">$dnsResolverFactory</span><span class="pl-k">-&gt;</span>createCached(<span class="pl-s"><span class="pl-pds">'</span>127.0.1.1<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"><span class="pl-smi">$tcp</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">DnsConnector</span>(<span class="pl-k">new</span> <span class="pl-c1">TcpConnector</span>(<span class="pl-smi">$loop</span>), <span class="pl-smi">$resolver</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$tls</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">SecureConnector</span>(<span class="pl-smi">$tcp</span>, <span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$unix</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">UnixConnector</span>(<span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$connector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Connector</span>(<span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>tcp<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$tcp</span>,</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>tls<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$tls</span>,</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>unix<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$unix</span>,</span>
<span class="pl-s1"></span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>dns<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span>,</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>timeout<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span>,</span>
<span class="pl-s1">));</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$connector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>google.com:80<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>then(<span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>end();</span>
<span class="pl-s1">});</span></pre></div>
<blockquote>
<p>Internally, the <code>tcp://</code> connector will always be wrapped by the DNS resolver,
unless you disable DNS like in the above example. In this case, the <code>tcp://</code>
connector receives the actual hostname instead of only the resolved IP address
and is thus responsible for performing the lookup.
Internally, the automatically created <code>tls://</code> connector will always wrap the
underlying <code>tcp://</code> connector for establishing the underlying plaintext
TCP/IP connection before enabling secure TLS mode. If you want to use a custom
underlying <code>tcp://</code> connector for secure TLS connections only, you may
explicitly pass a <code>tls://</code> connector like above instead.
Internally, the <code>tcp://</code> and <code>tls://</code> connectors will always be wrapped by
<code>TimeoutConnector</code>, unless you disable timeouts like in the above example.</p>
</blockquote>
<h3>
<a id="advanced-client-usage" class="anchor" href="#advanced-client-usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Advanced client usage</h3>
<h4>
<a id="tcpconnector" class="anchor" href="#tcpconnector" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>TcpConnector</h4>
<p>The <code>React\Socket\TcpConnector</code> class implements the
<a href="#connectorinterface"><code>ConnectorInterface</code></a> and allows you to create plaintext
TCP/IP connections to any IP-port-combination:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$tcpConnector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">React\Socket\</span><span class="pl-c1">TcpConnector</span>(<span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$tcpConnector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>127.0.0.1:80<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>then(<span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>end();</span>
<span class="pl-s1">});</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$loop</span><span class="pl-k">-&gt;</span>run();</span></pre></div>
<p>See also the <a href="https://github.com/reactphp/socket/blob/v0.8.9/examples">examples</a>.</p>
<p>Pending connection attempts can be cancelled by cancelling its pending promise like so:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$promise</span> <span class="pl-k">=</span> <span class="pl-smi">$tcpConnector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>127.0.0.1:80<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$promise</span><span class="pl-k">-&gt;</span>cancel();</span></pre></div>
<p>Calling <code>cancel()</code> on a pending promise will close the underlying socket
resource, thus cancelling the pending TCP/IP connection, and reject the
resulting promise.</p>
<p>You can optionally pass additional
<a href="http://php.net/manual/en/context.socket.php" rel="nofollow">socket context options</a>
to the constructor like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$tcpConnector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">React\Socket\</span><span class="pl-c1">TcpConnector</span>(<span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>bindto<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>192.168.0.1:0<span class="pl-pds">'</span></span></span>
<span class="pl-s1">));</span></pre></div>
<p>Note that this class only allows you to connect to IP-port-combinations.
If the given URI is invalid, does not contain a valid IP address and port
or contains any other scheme, it will reject with an
<code>InvalidArgumentException</code>:</p>
<p>If the given URI appears to be valid, but connecting to it fails (such as if
the remote host rejects the connection etc.), it will reject with a
<code>RuntimeException</code>.</p>
<p>If you want to connect to hostname-port-combinations, see also the following chapter.</p>
<blockquote>
<p>Advanced usage: Internally, the <code>TcpConnector</code> allocates an empty <em>context</em>
resource for each stream resource.
If the destination URI contains a <code>hostname</code> query parameter, its value will
be used to set up the TLS peer name.
This is used by the <code>SecureConnector</code> and <code>DnsConnector</code> to verify the peer
name and can also be used if you want a custom TLS peer name.</p>
</blockquote>
<h4>
<a id="dnsconnector" class="anchor" href="#dnsconnector" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>DnsConnector</h4>
<p>The <code>DnsConnector</code> class implements the
<a href="#connectorinterface"><code>ConnectorInterface</code></a> and allows you to create plaintext
TCP/IP connections to any hostname-port-combination.</p>
<p>It does so by decorating a given <code>TcpConnector</code> instance so that it first
looks up the given domain name via DNS (if applicable) and then establishes the
underlying TCP/IP connection to the resolved target IP address.</p>
<p>Make sure to set up your DNS resolver and underlying TCP connector like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$dnsResolverFactory</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">React\Dns\Resolver\</span><span class="pl-c1">Factory</span>();</span>
<span class="pl-s1"><span class="pl-smi">$dns</span> <span class="pl-k">=</span> <span class="pl-smi">$dnsResolverFactory</span><span class="pl-k">-&gt;</span>createCached(<span class="pl-s"><span class="pl-pds">'</span>8.8.8.8<span class="pl-pds">'</span></span>, <span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$dnsConnector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">React\Socket\</span><span class="pl-c1">DnsConnector</span>(<span class="pl-smi">$tcpConnector</span>, <span class="pl-smi">$dns</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$dnsConnector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>www.google.com:80<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>then(<span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>end();</span>
<span class="pl-s1">});</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$loop</span><span class="pl-k">-&gt;</span>run();</span></pre></div>
<p>See also the <a href="https://github.com/reactphp/socket/blob/v0.8.9/examples">examples</a>.</p>
<p>Pending connection attempts can be cancelled by cancelling its pending promise like so:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$promise</span> <span class="pl-k">=</span> <span class="pl-smi">$dnsConnector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>www.google.com:80<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$promise</span><span class="pl-k">-&gt;</span>cancel();</span></pre></div>
<p>Calling <code>cancel()</code> on a pending promise will cancel the underlying DNS lookup
and/or the underlying TCP/IP connection and reject the resulting promise.</p>
<blockquote>
<p>Advanced usage: Internally, the <code>DnsConnector</code> relies on a <code>Resolver</code> to
look up the IP address for the given hostname.
It will then replace the hostname in the destination URI with this IP and
append a <code>hostname</code> query parameter and pass this updated URI to the underlying
connector.
The underlying connector is thus responsible for creating a connection to the
target IP address, while this query parameter can be used to check the original
hostname and is used by the <code>TcpConnector</code> to set up the TLS peer name.
If a <code>hostname</code> is given explicitly, this query parameter will not be modified,
which can be useful if you want a custom TLS peer name.</p>
</blockquote>
<h4>
<a id="secureconnector" class="anchor" href="#secureconnector" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>SecureConnector</h4>
<p>The <code>SecureConnector</code> class implements the
<a href="#connectorinterface"><code>ConnectorInterface</code></a> and allows you to create secure
TLS (formerly known as SSL) connections to any hostname-port-combination.</p>
<p>It does so by decorating a given <code>DnsConnector</code> instance so that it first
creates a plaintext TCP/IP connection and then enables TLS encryption on this
stream.</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$secureConnector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">React\Socket\</span><span class="pl-c1">SecureConnector</span>(<span class="pl-smi">$dnsConnector</span>, <span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$secureConnector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>www.google.com:443<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>then(<span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">"</span>GET / HTTP/1.0<span class="pl-cce">\r\n</span>Host: www.google.com<span class="pl-cce">\r\n\r\n</span><span class="pl-pds">"</span></span>);</span>
<span class="pl-s1">    <span class="pl-k">...</span></span>
<span class="pl-s1">});</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$loop</span><span class="pl-k">-&gt;</span>run();</span></pre></div>
<p>See also the <a href="https://github.com/reactphp/socket/blob/v0.8.9/examples">examples</a>.</p>
<p>Pending connection attempts can be cancelled by cancelling its pending promise like so:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$promise</span> <span class="pl-k">=</span> <span class="pl-smi">$secureConnector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>www.google.com:443<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$promise</span><span class="pl-k">-&gt;</span>cancel();</span></pre></div>
<p>Calling <code>cancel()</code> on a pending promise will cancel the underlying TCP/IP
connection and/or the SSL/TLS negotiation and reject the resulting promise.</p>
<p>You can optionally pass additional
<a href="http://php.net/manual/en/context.ssl.php" rel="nofollow">SSL context options</a>
to the constructor like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$secureConnector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">React\Socket\</span><span class="pl-c1">SecureConnector</span>(<span class="pl-smi">$dnsConnector</span>, <span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>verify_peer<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span>,</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>verify_peer_name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span></span>
<span class="pl-s1">));</span></pre></div>
<p>By default, this connector supports TLSv1.0+ and excludes support for legacy
SSLv2/SSLv3. As of PHP 5.6+ you can also explicitly choose the TLS version you
want to negotiate with the remote side:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$secureConnector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">React\Socket\</span><span class="pl-c1">SecureConnector</span>(<span class="pl-smi">$dnsConnector</span>, <span class="pl-smi">$loop</span>, <span class="pl-c1">array</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>crypto_method<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">STREAM_CRYPTO_METHOD_TLSv1_2_CLIENT</span></span>
<span class="pl-s1">));</span></pre></div>
<blockquote>
<p>Advanced usage: Internally, the <code>SecureConnector</code> relies on setting up the
required <em>context options</em> on the underlying stream resource.
It should therefor be used with a <code>TcpConnector</code> somewhere in the connector
stack so that it can allocate an empty <em>context</em> resource for each stream
resource and verify the peer name.
Failing to do so may result in a TLS peer name mismatch error or some hard to
trace race conditions, because all stream resources will use a single, shared
<em>default context</em> resource otherwise.</p>
</blockquote>
<h4>
<a id="timeoutconnector" class="anchor" href="#timeoutconnector" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>TimeoutConnector</h4>
<p>The <code>TimeoutConnector</code> class implements the
<a href="#connectorinterface"><code>ConnectorInterface</code></a> and allows you to add timeout
handling to any existing connector instance.</p>
<p>It does so by decorating any given <a href="#connectorinterface"><code>ConnectorInterface</code></a>
instance and starting a timer that will automatically reject and abort any
underlying connection attempt if it takes too long.</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$timeoutConnector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">React\Socket\</span><span class="pl-c1">TimeoutConnector</span>(<span class="pl-smi">$connector</span>, <span class="pl-c1">3.0</span>, <span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$timeoutConnector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>google.com:80<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>then(<span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-c"><span class="pl-c">//</span> connection succeeded within 3.0 seconds</span></span>
<span class="pl-s1">});</span></pre></div>
<p>See also any of the <a href="https://github.com/reactphp/socket/blob/v0.8.9/examples">examples</a>.</p>
<p>Pending connection attempts can be cancelled by cancelling its pending promise like so:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$promise</span> <span class="pl-k">=</span> <span class="pl-smi">$timeoutConnector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>google.com:80<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$promise</span><span class="pl-k">-&gt;</span>cancel();</span></pre></div>
<p>Calling <code>cancel()</code> on a pending promise will cancel the underlying connection
attempt, abort the timer and reject the resulting promise.</p>
<h4>
<a id="unixconnector" class="anchor" href="#unixconnector" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>UnixConnector</h4>
<p>The <code>UnixConnector</code> class implements the
<a href="#connectorinterface"><code>ConnectorInterface</code></a> and allows you to connect to
Unix domain socket (UDS) paths like this:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$connector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">React\Socket\</span><span class="pl-c1">UnixConnector</span>(<span class="pl-smi">$loop</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$connector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>/tmp/demo.sock<span class="pl-pds">'</span></span>)<span class="pl-k">-&gt;</span>then(<span class="pl-k">function</span> (<span class="pl-c1">ConnectionInterface</span> <span class="pl-smi">$connection</span>) {</span>
<span class="pl-s1">    <span class="pl-smi">$connection</span><span class="pl-k">-&gt;</span>write(<span class="pl-s"><span class="pl-pds">"</span>HELLO<span class="pl-cce">\n</span><span class="pl-pds">"</span></span>);</span>
<span class="pl-s1">});</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$loop</span><span class="pl-k">-&gt;</span>run();</span></pre></div>
<p>Connecting to Unix domain sockets is an atomic operation, i.e. its promise will
settle (either resolve or reject) immediately.
As such, calling <code>cancel()</code> on the resulting promise has no effect.</p>
<blockquote>
<p>The <a href="#getremoteaddress"><code>getRemoteAddress()</code></a> method will return the target
Unix domain socket (UDS) path as given to the <code>connect()</code> method, prepended
with the <code>unix://</code> scheme, for example <code>unix:///tmp/demo.sock</code>.
The <a href="#getlocaladdress"><code>getLocalAddress()</code></a> method will most likely return a
<code>null</code> value as this value is not applicable to UDS connections here.</p>
</blockquote>
<h4>
<a id="fixeduriconnector" class="anchor" href="#fixeduriconnector" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>FixedUriConnector</h4>
<p>The <code>FixedUriConnector</code> class implements the
<a href="#connectorinterface"><code>ConnectorInterface</code></a> and decorates an existing Connector
to always use a fixed, preconfigured URI.</p>
<p>This can be useful for consumers that do not support certain URIs, such as
when you want to explicitly connect to a Unix domain socket (UDS) path
instead of connecting to a default address assumed by an higher-level API:</p>
<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$connector</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">FixedUriConnector</span>(</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>unix:///var/run/docker.sock<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">    <span class="pl-k">new</span> <span class="pl-c1">UnixConnector</span>(<span class="pl-smi">$loop</span>)</span>
<span class="pl-s1">);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c"><span class="pl-c">//</span> destination will be ignored, actually connects to Unix domain socket</span></span>
<span class="pl-s1"><span class="pl-smi">$promise</span> <span class="pl-k">=</span> <span class="pl-smi">$connector</span><span class="pl-k">-&gt;</span>connect(<span class="pl-s"><span class="pl-pds">'</span>localhost:80<span class="pl-pds">'</span></span>);</span></pre></div>
<h2>
<a id="install" class="anchor" href="#install" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Install</h2>
<p>The recommended way to install this library is <a href="https://getcomposer.org" rel="nofollow">through Composer</a>.
<a href="https://getcomposer.org/doc/00-intro.md" rel="nofollow">New to Composer?</a></p>
<p>This will install the latest supported version:</p>
<div class="highlight highlight-source-shell"><pre>$ composer require react/socket:^0.8.9</pre></div>
<p>See also the <a href="changelog.html">CHANGELOG</a> for details about version upgrades.</p>
<p>This project aims to run on any platform and thus does not require any PHP
extensions and supports running on legacy PHP 5.3 through current PHP 7+ and HHVM.
It's <em>highly recommended to use PHP 7+</em> for this project, partly due to its vast
performance improvements and partly because legacy PHP versions require several
workarounds as described below.</p>
<p>Secure TLS connections received some major upgrades starting with PHP 5.6, with
the defaults now being more secure, while older versions required explicit
context options.
This library does not take responsibility over these context options, so it's
up to consumers of this library to take care of setting appropriate context
options as described above.</p>
<p>All versions of PHP prior to 5.6.8 suffered from a buffering issue where reading
from a streaming TLS connection could be one <code>data</code> event behind.
This library implements a work-around to try to flush the complete incoming
data buffers on these legacy PHP versions, which has a penalty of around 10% of
throughput on all connections.
With this work-around, we have not been able to reproduce this issue anymore,
but we have seen reports of people saying this could still affect some of the
older PHP versions (<code>5.5.23</code>, <code>5.6.7</code>, and <code>5.6.8</code>).
Note that this only affects <em>some</em> higher-level streaming protocols, such as
IRC over TLS, but should not affect HTTP over TLS (HTTPS).
Further investigation of this issue is needed.
For more insights, this issue is also covered by our test suite.</p>
<p>PHP &lt; 7.1.4 (and PHP &lt; 7.0.18) suffers from a bug when writing big
chunks of data over TLS streams at once.
We try to work around this by limiting the write chunk size to 8192
bytes for older PHP versions only.
This is only a work-around and has a noticable performance penalty on
affected versions.</p>
<p>This project also supports running on HHVM.
Note that really old HHVM &lt; 3.8 does not support secure TLS connections, as it
lacks the required <code>stream_socket_enable_crypto()</code> function.
As such, trying to create a secure TLS connections on affected versions will
return a rejected promise instead.
This issue is also covered by our test suite, which will skip related tests
on affected versions.</p>
<h2>
<a id="tests" class="anchor" href="#tests" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Tests</h2>
<p>To run the test suite, you first need to clone this repo and then install all
dependencies <a href="https://getcomposer.org" rel="nofollow">through Composer</a>.
Because the test suite contains some circular dependencies, you may have to
manually specify the root package version like this:</p>
<div class="highlight highlight-source-shell"><pre>$ COMPOSER_ROOT_VERSION=<span class="pl-s"><span class="pl-pds">`</span>git describe --abbrev=0<span class="pl-pds">`</span></span> composer install</pre></div>
<p>To run the test suite, go to the project root and run:</p>
<div class="highlight highlight-source-shell"><pre>$ php vendor/bin/phpunit</pre></div>
<p>The test suite also contains a number of functional integration tests that rely
on a stable internet connection.
If you do not want to run these, they can simply be skipped like this:</p>
<div class="highlight highlight-source-shell"><pre>$ php vendor/bin/phpunit --exclude-group internet</pre></div>
<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>License</h2>
<p>MIT, see <a href="license.html">LICENSE file</a>.</p>
                </main>
                <aside class="sidebar" role="complementary">
                    <section class="component-info">
                        <h2 class="component-info__title">
                            <a href="../socket/">Socket</a>

                            <div class="version-selector">
                                <button class="version-selector__button version-selector__button--latest" aria-expanded="false" aria-controls="component-version-selector" data-version-selector-toggle>
                                    v0.8.9

                                    <i class="icon-chevron-down" aria-hidden="true"></i>
                                    <i class="icon-chevron-up" aria-hidden="true"></i>
                                </button>

                                <div id="component-version-selector" class="version-selector__panel" aria-hidden="true">
                                    <p>Read the documentation of development and older versions on GitHub:</p>

                                    <ul class="version-selector__list">
                                        <li>
                                            <a href="https://github.com/reactphp/socket#readme" class="version-selector__version version-selector__version--dev">
                                                master
                                            </a>
                                        </li>
                                                                                                                                                                                                                    <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.8.8#readme" class="version-selector__version">
                                                    v0.8.8
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.8.7#readme" class="version-selector__version">
                                                    v0.8.7
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.8.6#readme" class="version-selector__version">
                                                    v0.8.6
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.8.5#readme" class="version-selector__version">
                                                    v0.8.5
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.8.4#readme" class="version-selector__version">
                                                    v0.8.4
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.8.3#readme" class="version-selector__version">
                                                    v0.8.3
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.8.2#readme" class="version-selector__version">
                                                    v0.8.2
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.8.1#readme" class="version-selector__version">
                                                    v0.8.1
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.8.0#readme" class="version-selector__version">
                                                    v0.8.0
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.7.2#readme" class="version-selector__version">
                                                    v0.7.2
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.7.1#readme" class="version-selector__version">
                                                    v0.7.1
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.7.0#readme" class="version-selector__version">
                                                    v0.7.0
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.6.0#readme" class="version-selector__version">
                                                    v0.6.0
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.5.1#readme" class="version-selector__version">
                                                    v0.5.1
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.5.0#readme" class="version-selector__version">
                                                    v0.5.0
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.4.6#readme" class="version-selector__version">
                                                    v0.4.6
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.4.5#readme" class="version-selector__version">
                                                    v0.4.5
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.4.4#readme" class="version-selector__version">
                                                    v0.4.4
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.4.3#readme" class="version-selector__version">
                                                    v0.4.3
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.4.2#readme" class="version-selector__version">
                                                    v0.4.2
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.4.1#readme" class="version-selector__version">
                                                    v0.4.1
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.4.0#readme" class="version-selector__version">
                                                    v0.4.0
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.3.4#readme" class="version-selector__version">
                                                    v0.3.4
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.3.3#readme" class="version-selector__version">
                                                    v0.3.3
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.3.2#readme" class="version-selector__version">
                                                    v0.3.2
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.3.1#readme" class="version-selector__version">
                                                    v0.3.1
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.3.0#readme" class="version-selector__version">
                                                    v0.3.0
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.2.6#readme" class="version-selector__version">
                                                    v0.2.6
                                                </a>
                                            </li>
                                                                                                                                                                            <li>
                                                <a href="https://github.com/reactphp/socket/tree/v0.2.3#readme" class="version-selector__version">
                                                    v0.2.3
                                                </a>
                                            </li>
                                                                                                                        </ul>
                                </div>
                            </div>
                        </h2>

                        <ul class="component-info__info">
                            <li>
                                <a href="https://github.com/reactphp/socket">
                                    <i class="icon-github" aria-hidden="true"></i> Repository
                                </a>
                            </li>
                            <li>
                                <a href="../socket/changelog.html">
                                    <i class="icon-calendar" aria-hidden="true"></i> Changelog
                                </a>
                            </li>
                            <li>
                                <a href="../socket/license.html">
                                    <i class="icon-law" aria-hidden="true"></i> MIT License
                                </a>
                            </li>
                        </ul>

                        <h3 class="component-info__subtitle">Installation</h3>

                        <div class="highlight highlight-source-shell"><pre>composer require react/socket:^0.8.9</pre></div>

                        <h3 class="component-info__subtitle">Contributors</h3>

                        <ul class="component-info__contributors">
                                                    <li>
                                <a href="https://github.com/clue">
                                    <img src="https://avatars1.githubusercontent.com/u/776829?v=4&amp;s=40" srcset="https://avatars1.githubusercontent.com/u/776829?v=4&amp;s=80 2x" alt="clue" title="clue (247 contributions)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/cboden">
                                    <img src="https://avatars0.githubusercontent.com/u/617694?v=4&amp;s=40" srcset="https://avatars0.githubusercontent.com/u/617694?v=4&amp;s=80 2x" alt="cboden" title="cboden (87 contributions)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/igorw">
                                    <img src="https://avatars2.githubusercontent.com/u/88061?v=4&amp;s=40" srcset="https://avatars2.githubusercontent.com/u/88061?v=4&amp;s=80 2x" alt="igorw" title="igorw (69 contributions)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/WyriHaximus">
                                    <img src="https://avatars2.githubusercontent.com/u/147145?v=4&amp;s=40" srcset="https://avatars2.githubusercontent.com/u/147145?v=4&amp;s=80 2x" alt="WyriHaximus" title="WyriHaximus (42 contributions)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/jsor">
                                    <img src="https://avatars2.githubusercontent.com/u/55574?v=4&amp;s=40" srcset="https://avatars2.githubusercontent.com/u/55574?v=4&amp;s=80 2x" alt="jsor" title="jsor (8 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/andig">
                                    <img src="https://avatars1.githubusercontent.com/u/184815?v=4&amp;s=40" srcset="https://avatars1.githubusercontent.com/u/184815?v=4&amp;s=80 2x" alt="andig" title="andig (5 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/carusogabriel">
                                    <img src="https://avatars3.githubusercontent.com/u/16328050?v=4&amp;s=40" srcset="https://avatars3.githubusercontent.com/u/16328050?v=4&amp;s=80 2x" alt="carusogabriel" title="carusogabriel (3 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/artggd">
                                    <img src="https://avatars2.githubusercontent.com/u/1837559?v=4&amp;s=40" srcset="https://avatars2.githubusercontent.com/u/1837559?v=4&amp;s=80 2x" alt="artggd" title="artggd (2 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/tkleinhakisa">
                                    <img src="https://avatars3.githubusercontent.com/u/1912952?v=4&amp;s=40" srcset="https://avatars3.githubusercontent.com/u/1912952?v=4&amp;s=80 2x" alt="tkleinhakisa" title="tkleinhakisa (2 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/robinvdvleuten">
                                    <img src="https://avatars3.githubusercontent.com/u/238295?v=4&amp;s=40" srcset="https://avatars3.githubusercontent.com/u/238295?v=4&amp;s=80 2x" alt="robinvdvleuten" title="robinvdvleuten (2 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/psychoticmeow">
                                    <img src="https://avatars1.githubusercontent.com/u/25459?v=4&amp;s=40" srcset="https://avatars1.githubusercontent.com/u/25459?v=4&amp;s=80 2x" alt="psychoticmeow" title="psychoticmeow (2 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/valga">
                                    <img src="https://avatars2.githubusercontent.com/u/23472603?v=4&amp;s=40" srcset="https://avatars2.githubusercontent.com/u/23472603?v=4&amp;s=80 2x" alt="valga" title="valga (1 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/alexmace">
                                    <img src="https://avatars2.githubusercontent.com/u/207391?v=4&amp;s=40" srcset="https://avatars2.githubusercontent.com/u/207391?v=4&amp;s=80 2x" alt="alexmace" title="alexmace (1 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/DaveRandom">
                                    <img src="https://avatars1.githubusercontent.com/u/2396425?v=4&amp;s=40" srcset="https://avatars1.githubusercontent.com/u/2396425?v=4&amp;s=80 2x" alt="DaveRandom" title="DaveRandom (1 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/christiaan">
                                    <img src="https://avatars0.githubusercontent.com/u/118490?v=4&amp;s=40" srcset="https://avatars0.githubusercontent.com/u/118490?v=4&amp;s=80 2x" alt="christiaan" title="christiaan (1 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/elliot">
                                    <img src="https://avatars2.githubusercontent.com/u/9938?v=4&amp;s=40" srcset="https://avatars2.githubusercontent.com/u/9938?v=4&amp;s=80 2x" alt="elliot" title="elliot (1 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/hansott">
                                    <img src="https://avatars1.githubusercontent.com/u/3886384?v=4&amp;s=40" srcset="https://avatars1.githubusercontent.com/u/3886384?v=4&amp;s=80 2x" alt="hansott" title="hansott (1 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/kelunik">
                                    <img src="https://avatars0.githubusercontent.com/u/2743004?v=4&amp;s=40" srcset="https://avatars0.githubusercontent.com/u/2743004?v=4&amp;s=80 2x" alt="kelunik" title="kelunik (1 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/Sgoettschkes">
                                    <img src="https://avatars1.githubusercontent.com/u/628796?v=4&amp;s=40" srcset="https://avatars1.githubusercontent.com/u/628796?v=4&amp;s=80 2x" alt="Sgoettschkes" title="Sgoettschkes (1 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/cn007b">
                                    <img src="https://avatars1.githubusercontent.com/u/5052324?v=4&amp;s=40" srcset="https://avatars1.githubusercontent.com/u/5052324?v=4&amp;s=80 2x" alt="cn007b" title="cn007b (1 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/e3betht">
                                    <img src="https://avatars0.githubusercontent.com/u/1811561?v=4&amp;s=40" srcset="https://avatars0.githubusercontent.com/u/1811561?v=4&amp;s=80 2x" alt="e3betht" title="e3betht (1 contribution)">
                                </a>
                            </li>
                                                    <li>
                                <a href="https://github.com/the-eater">
                                    <img src="https://avatars2.githubusercontent.com/u/1922630?v=4&amp;s=40" srcset="https://avatars2.githubusercontent.com/u/1922630?v=4&amp;s=80 2x" alt="the-eater" title="the-eater (1 contribution)">
                                </a>
                            </li>
                                                </ul>

                        <h3 class="component-info__subtitle">Activity</h3>

                        <div class="component-info__participation">
                            <svg width="320" height="42">
    <defs>
        <linearGradient id="reactphp-socket-participation-gradient" x1="0" x2="0" y1="1" y2="0">
            <stop offset="10%" stop-color="#40a977"></stop>
            <stop offset="90%" stop-color="#ba3525"></stop>
        </linearGradient>
        <mask id="reactphp-socket-participation-sparkline" x="0" y="0" width="320" height="40" >
            <polyline 
                transform="translate(0, 40) scale(1,-1)"
                points="0,6 6,11 12,15 18,4 24,8 30,3 36,4 42,12 48,7 54,11 60,11 66,6 72,1 78,5 84,9 90,8 96,3 102,3 108,1 114,1 120,5 126,1 132,1 138,1 144,1 150,1 156,1 162,1 168,6 174,3 180,1 186,4 192,4 198,3 204,4 210,1 216,4 222,13 228,4 234,4 240,1 246,1 252,5 258,9 264,1 270,3 276,1 282,1 288,5 294,4 300,5 306,4" 
                fill="transparent" 
                stroke="#40a977" 
                stroke-width="2"
            >
        </mask>
    </defs>

    <g transform="translate(0, -1.5)">
        <rect 
            x="0" 
            y="-2" 
            width="320" 
            height="42"
            style="stroke:none;fill:url(#reactphp-socket-participation-gradient);mask:url(#reactphp-socket-participation-sparkline)"
        ></rect>
    </g>
</svg>
                        </div>
                    </section>
                </aside>
            </div>
        </div>
    </div>

            <footer class="footer">
            <div class="wrapper">
                <ul class="links">
                    <li><a href="https://github.com/reactphp"><i class="icon-github" aria-hidden="true"></i> GitHub</a></li>
                    <li><a href="https://twitter.com/reactphp"><i class="icon-twitter" aria-hidden="true"></i> Twitter</a></li>
                    <li><a href="irc://irc.freenode.net/reactphp"><i class="icon-hash" aria-hidden="true"></i> IRC</a></li>
                </ul>
            </div>
        </footer>
    
    <script async src="../assets/main.2c3050a7d983f67a1210.js"></script>
    </body>
</html>
